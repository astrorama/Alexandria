/*
 * Copyright (C) 2012-2021 Euclid Science Ground Segment
 *
 * This library is free software; you can redistribute it and/or modify it under
 * the terms of the GNU Lesser General Public License as published by the Free
 * Software Foundation; either version 3.0 of the License, or (at your option)
 * any later version.
 *
 * This library is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more
 * details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with this library; if not, write to the Free Software Foundation, Inc.,
 * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
 */

/**
 * 2D distribution
 * Generated combining two 2D gaussian, so it is bimodal

from scipy.stats import multivariate_normal
d0 = multivariate_normal(mean=[5, 22], cov=[[3,2],[2,2]])
d1 = multivariate_normal(mean=[11, 31], cov=[[3,-2],[-2,2]])

def pdf(pos):
    return (d0.pdf(pos) + d1.pdf(pos)) / 2

The grid is sampled from this distribution as follows:

knots_x = np.linspace(-1, 20, 22)
knots_y = np.linspace(15, 36, 21)

x, y = np.meshgrid(knots_x, knots_y)
pos = np.dstack((x, y))
# Note the transpose to follow GridContainer memory layout
values = pdf(pos).T
 */
struct N2DistributionFixture : public RandomFixture {
  NdArray<double> pdf{
      {22, 21}, {//
                 1.63312901e-07, 8.05294385e-06, 7.59756368e-05, 1.37144857e-04, 4.73663812e-05, 3.13001476e-06, 3.95738284e-08,
                 9.57315843e-11, 4.43085897e-14, 3.92379319e-18, 6.64828749e-23, 2.15525655e-28, 1.33682223e-34, 1.58647995e-41,
                 1.43090325e-40, 1.43824026e-34, 2.76591046e-29, 1.01772464e-24, 7.16486426e-21, 9.65097394e-18, 2.48725218e-15,
                 3.64400338e-08, 5.13478370e-06, 1.38436636e-04, 7.14110506e-04, 7.04799046e-04, 1.33091614e-04, 4.80863241e-06,
                 3.32412974e-08, 4.39662933e-11, 1.11262097e-14, 5.38716315e-19, 4.99066613e-24, 8.84590776e-30, 2.99996286e-36,
                 5.18298125e-35, 1.82302072e-29, 1.22684323e-24, 1.57969063e-20, 3.89171037e-17, 1.83440186e-14, 1.65437497e-12,
                 2.99118012e-09, 1.20446769e-06, 9.27968524e-05, 1.36790783e-03, 3.85803290e-03, 2.08190313e-03, 2.14951564e-04,
                 4.24625629e-06, 1.60493444e-08, 1.16063026e-11, 1.60589070e-15, 4.25131787e-20, 2.15336016e-25, 2.08697675e-31,
                 6.90644448e-30, 8.50075079e-25, 2.00191460e-20, 9.02026528e-17, 7.77639968e-14, 1.28269481e-11, 4.04812209e-10,
                 9.03258131e-11, 1.03937837e-07, 2.28834221e-05, 9.63948356e-04, 7.76912419e-03, 1.19805253e-02, 3.53480255e-03,
                 1.99544590e-04, 2.15526292e-06, 4.45395738e-09, 1.76107299e-12, 1.33227586e-16, 1.92839705e-21, 5.34203272e-27,
                 3.38559442e-25, 1.45823824e-20, 1.20173176e-16, 1.89483805e-13, 5.71639399e-11, 3.29957278e-09, 3.64400338e-08,
                 1.00342914e-12, 3.29957278e-09, 2.07593721e-06, 2.49894223e-04, 5.75550876e-03, 2.53627723e-02, 2.13843093e-02,
                 3.44968334e-03, 1.06475267e-04, 6.28787272e-07, 7.10467553e-10, 1.53592587e-13, 6.35304253e-18, 5.03555936e-23,
                 6.10549465e-21, 9.20248672e-17, 2.65384192e-13, 1.46430114e-10, 1.54586389e-08, 3.12246519e-07, 1.20672819e-06,
                 4.10078557e-15, 3.85342817e-11, 6.92808130e-08, 2.38322027e-05, 1.56855912e-03, 1.97525469e-02, 4.75916555e-02,
                 2.19393635e-02, 1.93509698e-03, 3.26562976e-05, 1.05442734e-07, 6.51406175e-11, 7.69967837e-15, 1.75601425e-19,
                 4.05053415e-17, 2.13642393e-13, 2.15599664e-10, 4.16288318e-08, 1.53789211e-06, 1.08703372e-05, 1.47009589e-05,
                 6.16528175e-18, 1.65555015e-13, 8.50584090e-10, 8.36137439e-07, 1.57261924e-04, 5.65919945e-03, 3.89647520e-02,
                 5.13303627e-02, 1.29378541e-02, 6.23929712e-04, 5.75697821e-06, 1.01633997e-08, 3.43296143e-12, 2.32110482e-16,
                 9.88574176e-14, 1.82463158e-10, 6.44357111e-08, 4.35375078e-06, 5.62841361e-05, 1.39217537e-04, 6.58851267e-05,
                 3.40992097e-21, 2.61663372e-16, 3.84173189e-12, 1.07918692e-08, 5.80031787e-06, 5.96475233e-04, 1.17359578e-02,
                 4.41804526e-02, 3.18219862e-02, 4.38540702e-03, 1.15631998e-04, 5.83353296e-07, 5.63080883e-10, 1.30283938e-13,
                 8.87588658e-11, 5.73282201e-08, 7.08452424e-06, 1.67509107e-04, 7.57794864e-04, 6.55919272e-04, 1.08626210e-04,
                 6.93811059e-25, 1.52141973e-19, 6.38325757e-15, 5.12414246e-11, 7.87019553e-08, 2.31278547e-05, 1.30038119e-03,
                 1.39891558e-02, 2.87937239e-02, 1.13393893e-02, 8.54411323e-04, 1.23177058e-05, 3.39764663e-08, 4.27487896e-11,
                 2.93170149e-08, 6.62624130e-06, 2.86549908e-04, 2.37093038e-03, 3.75338253e-03, 1.13687406e-03, 6.58851267e-05,
                 5.19330273e-29, 3.25432311e-23, 3.90178381e-18, 8.95058116e-14, 3.92848200e-10, 3.29901129e-07, 5.30064032e-05,
                 1.62951503e-03, 9.58459806e-03, 1.07863607e-02, 2.32253077e-03, 9.56827203e-05, 7.54211843e-07, 9.75493724e-09,
                 3.56232283e-06, 2.81754950e-04, 4.26378576e-03, 1.23453866e-02, 6.83910888e-03, 7.24902904e-04, 1.47009589e-05,
                 1.43005118e-33, 2.56081271e-27, 8.77383686e-22, 5.75157508e-17, 7.21389027e-13, 1.73116224e-09, 7.94861591e-07,
                 6.98281847e-05, 1.17369565e-03, 3.77455480e-03, 2.32253077e-03, 2.73427833e-04, 6.16044546e-06, 1.12734430e-06,
                 1.59240057e-04, 4.40738896e-03, 2.33397389e-02, 2.36480922e-02, 4.58439178e-03, 1.70040683e-04, 1.20672819e-06,
                 1.44865523e-38, 7.41311062e-32, 7.25807455e-26, 1.35965232e-20, 4.87326260e-16, 3.34192931e-12, 4.38490517e-09,
                 1.10080059e-06, 5.28740527e-05, 4.85916948e-04, 8.54411323e-04, 2.87446919e-04, 1.86981480e-05, 5.19578656e-05,
                 2.61864667e-03, 2.53627723e-02, 4.70004625e-02, 1.66645289e-02, 1.13049709e-03, 1.46734204e-05, 3.64400338e-08,
                 5.39863560e-44, 7.89457333e-37, 2.20881231e-30, 1.18242734e-24, 1.21108776e-19, 2.37335261e-15, 8.89886089e-12,
                 6.38398812e-09, 8.76264512e-07, 2.30125040e-05, 1.15632006e-04, 1.11187422e-04, 3.01077835e-05, 8.95016479e-04,
                 1.58418908e-02, 5.36929894e-02, 3.48187990e-02, 4.32011681e-03, 1.02556383e-04, 4.65817068e-07, 4.04812209e-10,
                 7.40130853e-50, 3.09287497e-42, 2.47287247e-35, 3.78291494e-29, 1.10722768e-23, 6.20058678e-19, 6.64376325e-15,
                 1.36201223e-11, 5.34236266e-09, 4.00932719e-07, 5.75814957e-06, 1.68529422e-05, 1.83861803e-04, 5.68840244e-03,
                 3.52567817e-02, 4.18161422e-02, 9.48922972e-03, 4.12005921e-04, 3.42264184e-06, 5.44007583e-09, 1.65437497e-12,
                 3.73283266e-56, 4.45760500e-48, 1.01847446e-40, 4.45229781e-34, 3.72394938e-28, 5.95948643e-23, 1.82473375e-18,
                 1.06900504e-14, 1.19868828e-11, 2.60921965e-09, 1.69396985e-07, 2.06348635e-05, 1.17493912e-03, 1.33072540e-02,
                 2.88658179e-02, 1.19805255e-02, 9.51379200e-04, 1.44549616e-05, 4.20209372e-08, 2.33722233e-11, 2.48725218e-15,
                 6.92767491e-63, 2.36643230e-54, 1.55254369e-46, 1.98451038e-39, 5.26315842e-33, 3.55533018e-27, 7.96499787e-22,
                 5.25908305e-17, 7.75883816e-13, 2.27382002e-09, 1.28526594e-06, 1.39233476e-04, 2.88689388e-03, 1.14534082e-02,
                 8.69422018e-03, 1.26273834e-03, 3.50898798e-05, 1.86567482e-07, 1.89790965e-10, 3.69403171e-14, 1.37566030e-18,
                 4.85540655e-61, 2.80093139e-52, 3.09146861e-44, 6.52848956e-37, 2.63782565e-30, 2.03922413e-24, 3.01626392e-19,
                 8.53609460e-15, 4.62204963e-11, 4.78845598e-08, 9.49165419e-06, 3.59976242e-04, 2.61210908e-03, 3.62655564e-03,
                 9.63347536e-04, 4.89617941e-05, 4.76121146e-07, 8.85857053e-10, 3.15352459e-13, 2.14790867e-17, 2.79913255e-22,
                 4.79305201e-56, 9.67564232e-48, 3.73708495e-40, 2.76166907e-33, 3.90477309e-27, 1.05634424e-21, 5.46764910e-17,
                 5.41478606e-13, 1.02600026e-09, 3.71962484e-07, 2.58009863e-05, 3.42419886e-04, 8.69495130e-04, 4.22435970e-04,
                 3.92681980e-05, 6.98422487e-07, 2.37761682e-09, 1.55655787e-12, 2.08580190e-16, 9.80030150e-21, 3.48684417e-25,
                 1.74062093e-51, 1.22959662e-43, 1.66190662e-36, 4.29769981e-30, 2.12642974e-24, 2.01303580e-19, 3.64617458e-15,
                 1.26359797e-11, 8.37849245e-09, 1.06293901e-06, 2.58009863e-05, 1.19825644e-04, 1.06475267e-04, 1.81022773e-05,
                 5.88849935e-07, 3.66626362e-09, 4.55116238e-12, 5.79762156e-15, 2.36477615e-17, 2.21941869e-20, 3.99260755e-24,
                 2.32542201e-47, 5.74845362e-40, 2.71885336e-33, 2.46040181e-27, 4.26002151e-22, 1.41124705e-17, 8.94498880e-14,
                 1.08478097e-10, 2.51703823e-08, 1.11743706e-06, 9.49165243e-06, 1.54257427e-05, 4.79662584e-06, 2.85371832e-07,
                 3.24843399e-09, 7.10762753e-12, 1.55164620e-14, 9.22708727e-16, 1.29543821e-17, 3.48068468e-20, 1.78936230e-23,
                 1.14289116e-43, 9.88655352e-37, 1.63632840e-30, 5.18181037e-25, 3.13962706e-20, 3.63965410e-16, 8.07286447e-13,
                 3.42594756e-10, 2.78175746e-08, 4.32158751e-07, 1.28455547e-06, 7.30546584e-07, 7.94929231e-08, 1.65498675e-09,
                 6.59248776e-12, 5.30784406e-15, 3.11465608e-16, 6.51739044e-17, 2.61544391e-18, 2.00818037e-20, 2.95015969e-23,
                 2.06639570e-40, 6.25524508e-34, 3.62293607e-28, 4.01478703e-23, 8.51235749e-19, 3.45320767e-15, 2.68028539e-12,
                 3.98038319e-10, 1.13097818e-08, 6.14849851e-08, 6.39542510e-08, 1.27278563e-08, 4.84648206e-10, 3.53088405e-12,
                 4.92187597e-15, 2.21484428e-18, 2.82626920e-18, 1.69394281e-18, 1.94258377e-19, 4.26232214e-21, 1.78936230e-23}};
  std::vector<double> knots_x1{-1., 0., 1., 2., 3., 4., 5., 6., 7., 8., 9., 10., 11., 12., 13., 14., 15., 16., 17., 18., 19., 20.};
  std::vector<double> knots_x0{15.,   16.05, 17.1,  18.15, 19.2,  20.25, 21.3,  22.35, 23.4,  24.45, 25.5,
                               26.55, 27.6,  28.65, 29.7,  30.75, 31.8,  32.85, 33.9,  34.95, 36.};
};
